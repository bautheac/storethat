<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>storethat • storethat</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="storethat">
<meta property="og:description" content="storethat">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">storethat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">home</a>
</li>
<li>
  <a href="../reference/index.html">functions</a>
</li>
<li>
  <a href="../articles/storethat.html">get started</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bautheac/storethat/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="storethat_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>storethat</h1>
                        <h4 class="author">Olivier Bauthéac</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bautheac/storethat/blob/master/vignettes/storethat.Rmd"><code>vignettes/storethat.Rmd</code></a></small>
      <div class="hidden name"><code>storethat.Rmd</code></div>

    </div>

    
    
<style> body {text-align: justify} </style>
<p><a href="https://bautheac.github.io/storethat/">storethat</a> together with <a href="https://bautheac.github.io/pullit/">pullit</a> are the two workhorses for data ETL (extract, transform, load) work in the <a href="https://bautheac.github.io/finRes/">finRes</a> suite. <a href="https://bautheac.github.io/storethat/">storethat</a> provides an off-Bloomberg storage facility for financial data retrieved from Bloomberg using the <a href="https://bautheac.github.io/pullit/">pullit</a> package. The package uses a SQLite database designed for easy and fast I/O (input/output) operations involving <a href="https://bautheac.github.io/pullit/">pullit</a> data objects.<br>
Install the development version with <code><a href="https://devtools.r-lib.org//reference/remote-reexports.html">devtools::install_github("bautheac/storethat")</a></code>.</p>
<div id="create" class="section level2">
<h2 class="hasAnchor">
<a href="#create" class="anchor"></a>create</h2>
<p>Start by creating a <a href="https://bautheac.github.io/storethat/">storethat</a> database wherever suits (defaults to home folder):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://bautheac.github.io/storethat">storethat</a></span><span class="op">)</span>

<span class="fu"><a href="../reference/db_create.html">db_create</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"~/data/"</span>, n <span class="op">=</span> <span class="fl">1L</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></code></pre></div>
<p>Using the <code>fields</code> dataset from the <a href="https://bautheac.github.io/BBGsymbols/">BBGsymbols</a> package that gathers common Bloomberg data field symbols, the function creates a SQLite database bespoke to host financial data retrieved from Bloomberg using the <a href="https://bautheac.github.io/pullit/">pullit</a> package. <code>n</code> is a space/speed trade-off parameter; it refers to the number of tables created for hosting historical data for each financial instrument category. Historical data tables are indexed by unique combinations of ticker, field and date ids. Writing new data to a table involves reconstructing its index, a process that continuously increases in strain as the volume of data grows and the index gets bigger; spreading the data across multiple tables helps contain the strain expansion and eventually improves the writing time performance of the database at the expense of disc space. Should disc space be cheaper than time, which is often the case, select a high value for <code>n</code>.</p>
</div>
<div id="store" class="section level2">
<h2 class="hasAnchor">
<a href="#store" class="anchor"></a>store</h2>
<p><a href="https://bautheac.github.io/storethat/">storethat</a> provides store methods for all objects returned by the <a href="https://bautheac.github.io/pullit/">pullit</a> package. Retrieve data from Bloomberg using <a href="https://bautheac.github.io/pullit/">pullit</a> and store it in an existing <a href="https://bautheac.github.io/storethat/">storethat</a> database using:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://bautheac.github.io/pullit">pullit</a></span><span class="op">)</span>

<span class="va">storethat</span> <span class="op">&lt;-</span> <span class="st">"~/data/storethat.sqlite"</span>; <span class="va">end</span> <span class="op">&lt;-</span> <span class="st">"2018-09-30"</span>; <span class="va">start</span> <span class="op">&lt;-</span> <span class="st">"2016-01-01"</span>
<span class="va">tickers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BP/ LN Equity"</span>, <span class="st">"WEIR LN Equity"</span>, <span class="st">"AAPL US Equity"</span>, <span class="st">"RNO FP Equity"</span><span class="op">)</span>
<span class="va">equity_market</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://bautheac.github.io/pullit/reference/pull_equity_market.html">pull_equity_market</a></span><span class="op">(</span>source <span class="op">=</span> <span class="st">"Bloomberg"</span>, <span class="va">tickers</span>, <span class="va">start</span>, <span class="va">end</span>, verbose <span class="op">=</span> <span class="cn">F</span>, file <span class="op">=</span> <span class="va">storethat</span><span class="op">)</span>

<span class="fu"><a href="../reference/db_store.html">db_store</a></span><span class="op">(</span><span class="va">equity_market</span>, file <span class="op">=</span> <span class="va">storethat</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; ✔ Period 2016-01-04/2016-01-07 done.
#&gt; ✔ Period 2016-01-08/2016-03-04 done.
#&gt; ✔ Period 2016-03-07/2016-05-02 done.
#&gt; ✔ Period 2016-05-03/2016-06-29 done.
#&gt; ✔ Period 2016-06-30/2016-08-26 done.
#&gt; ✔ Period 2016-08-29/2016-10-21 done.
#&gt; ✔ Period 2016-10-24/2016-12-20 done.
#&gt; ✔ Period 2016-12-21/2017-02-16 done.
#&gt; ✔ Period 2017-02-17/2017-04-13 done.
#&gt; ✔ Period 2017-04-17/2017-06-12 done.
#&gt; ✔ Period 2017-06-13/2017-08-09 done.
#&gt; ✔ Period 2017-08-10/2017-10-06 done.
#&gt; ✔ Period 2017-10-09/2017-12-01 done.
#&gt; ✔ Period 2017-12-04/2018-01-30 done.
#&gt; ✔ Period 2018-01-31/2018-03-29 done.
#&gt; ✔ Period 2018-04-02/2018-05-25 done.
#&gt; ✔ Period 2018-05-28/2018-07-23 done.
#&gt; ✔ Period 2018-07-24/2018-09-19 done.
#&gt; ✔ Period 2018-09-20/2018-09-28 done.</code></pre>
</div>
<div id="whats-in-there" class="section level2">
<h2 class="hasAnchor">
<a href="#whats-in-there" class="anchor"></a>what’s in there</h2>
<p>Check the content of an existing storethat database at anytime with:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">snapshot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/db_snapshot.html">db_snapshot</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">storethat</span>, instrument <span class="op">=</span> <span class="st">"equity"</span>, book <span class="op">=</span> <span class="st">"market"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">snapshot</span><span class="op">)</span>
<span class="co">#&gt;    instrument   book       field         ticker      start        end</span>
<span class="co">#&gt; 1:     equity market CUR_MKT_CAP AAPL US Equity 2010-01-04 2018-09-28</span>
<span class="co">#&gt; 2:     equity market CUR_MKT_CAP  BP/ LN Equity 2000-01-04 2018-09-28</span>
<span class="co">#&gt; 3:     equity market CUR_MKT_CAP  RNO FP Equity 2010-01-04 2018-09-28</span>
<span class="co">#&gt; 4:     equity market CUR_MKT_CAP WEIR LN Equity 2000-01-04 2018-09-28</span>
<span class="co">#&gt; 5:     equity market  EQY_SH_OUT AAPL US Equity 2010-01-04 2018-09-28</span>
<span class="co">#&gt; 6:     equity market  EQY_SH_OUT  BP/ LN Equity 2000-01-04 2018-09-28</span></code></pre></div>
</div>
<div id="update" class="section level2">
<h2 class="hasAnchor">
<a href="#update" class="anchor"></a>update</h2>
<p>Update content in an existing <a href="https://bautheac.github.io/storethat/">storethat</a> database using <a href="https://bautheac.github.io/pullit/">pullit</a>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://bautheac.github.io/pullit/reference/storethat_update.html">storethat_update</a></span><span class="op">(</span>
  instrument <span class="op">=</span> <span class="st">"equity"</span>, book <span class="op">=</span> <span class="st">"market"</span>, name <span class="op">=</span> <span class="st">"ADM US Equity"</span>, file <span class="op">=</span> <span class="va">storethat</span>, verbose <span class="op">=</span> <span class="cn">F</span>
  <span class="op">)</span></code></pre></div>
<p>Higher order updates are also allowed:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://bautheac.github.io/pullit/reference/storethat_update.html">storethat_update</a></span><span class="op">(</span>instrument <span class="op">=</span> <span class="st">"equity"</span>, file <span class="op">=</span> <span class="va">storethat</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></code></pre></div>
</div>
<div id="delete" class="section level2">
<h2 class="hasAnchor">
<a href="#delete" class="anchor"></a>delete</h2>
<p>Delete any content from an existing <a href="https://bautheac.github.io/storethat/">storethat</a> database with:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/db_delete.html">db_delete</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">storethat</span>, instrument <span class="op">=</span> <span class="st">"equity"</span>, book <span class="op">=</span> <span class="st">"market"</span>, name <span class="op">=</span> <span class="st">"ADM US Equity"</span><span class="op">)</span></code></pre></div>
<p>Or delete everything with:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/db_delete.html">db_delete</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">storethat</span><span class="op">)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Olivier Bauthéac.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
